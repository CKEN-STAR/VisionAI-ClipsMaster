# VisionAI-ClipsMaster 错误代码手册

## 错误代码速查表

| 代码    | 严重等级 | 检查方法              | 处理建议                                    |
|---------|----------|----------------------|-------------------------------------------|
| 0xE100  | 严重     | 检查XML模板合法性      | 验证XML文件是否符合规范，检查必填字段和格式       |
| 0xE101  | 高       | 验证法律声明注入流程    | 确保法律免责声明文本已正确注入到输出媒体中      |
| 0xE102  | 中       | 禁用硬件加速或更新驱动  | 如果与GPU相关，尝试禁用硬件加速或更新显卡驱动  |

## 错误严重程度说明

- **严重**：关键错误，阻止应用正常运行或严重影响功能，通常需要立即处理。
- **高**：重要错误，影响主要功能但不会导致整个应用崩溃。
- **中**：一般错误，影响特定功能但有替代解决方案。
- **低**：警告级别错误，表示潜在问题但不会立即影响功能。
- **信息**：信息级别错误，主要用于通知，通常不需要用户干预。

## 错误代码分类体系

VisionAI-ClipsMaster错误代码采用16进制格式，便于分类和识别：

- **0xE0xx**：基础错误（初始化、配置等）
- **0xE1xx**：文件操作错误（读写、格式等）
- **0xE2xx**：视频处理错误（编解码、合成等）
- **0xE3xx**：字幕相关错误（SRT格式、同步等）
- **0xE4xx**：模型相关错误（加载、推理等）
- **0xE5xx**：安全相关错误（验证、合规等）
- **0xE6xx**：资源相关错误（内存、CPU等）
- **0xE7xx**：网络相关错误（连接、下载等）
- **0xE8xx**：权限和授权错误（许可证等）
- **0xEFxx**：一般错误（未分类错误）

## 常见错误处理流程

1. **确认错误代码**：查看日志或错误提示，获取具体错误代码
2. **查阅手册**：根据错误代码查询本手册，了解错误性质和建议解决方案
3. **应用建议**：按照推荐方法尝试解决问题
4. **检查结果**：确认问题是否已解决
5. **记录信息**：如果问题反复出现，记录详细情况以供进一步分析

## 使用错误监控看板

VisionAI-ClipsMaster提供了实时错误监控看板，帮助跟踪和分析错误：

```python
from src.exporters.error_dashboard import get_error_monitor

# 获取错误监控看板实例
monitor = get_error_monitor()

# 启动监控
monitor.start_monitoring()

# 获取错误摘要
summary = monitor.get_error_summary()
print(f"错误状态: {summary['status']}")
print(f"总错误数: {summary['total_errors']}")
```

## 详细错误代码列表

### 基础错误 (0xE0xx)

| 代码 | 严重等级 | 错误描述 | 处理建议 |
|------|----------|----------|----------|
| 0xE000 | 低 | 未知错误 | 查看日志获取详细信息，重启应用程序 |
| 0xE001 | 严重 | 初始化错误 | 检查配置文件，重新安装应用程序 |
| 0xE002 | 低 | 配置错误 | 恢复默认配置或检查配置文件格式 |
| 0xE003 | 低 | 权限错误 | 以管理员权限运行或检查文件权限设置 |
| 0xE004 | 低 | 超时错误 | 检查网络连接，调整超时设置或重试 |
| 0xE005 | 信息 | 验证错误 | 检查输入数据格式和内容 |
| 0xE006 | 低 | 并发错误 | 减少同时任务数量或等待其他任务完成 |
| 0xE007 | 低 | 网络错误 | 检查网络连接和相关服务状态 |

### 文件操作错误 (0xE1xx)

| 代码 | 严重等级 | 错误描述 | 处理建议 |
|------|----------|----------|----------|
| 0xE100 | 低 | 文件未找到 | 检查文件路径，确认文件是否存在 |
| 0xE101 | 低 | 文件访问被拒绝 | 检查文件权限，以管理员身份运行应用程序 |
| 0xE102 | 低 | 文件格式错误 | 确保使用支持的文件格式 |
| 0xE103 | 低 | 文件大小错误 | 检查文件大小限制，尝试分割大文件 |
| 0xE104 | 低 | 文件操作错误 | 检查磁盘空间，确保文件未被其他程序锁定 |
| 0xE105 | 中 | 文件写入错误 | 检查磁盘空间和写入权限 |
| 0xE106 | 中 | 文件读取错误 | 检查文件是否损坏或被占用 |
| 0xE107 | 低 | 临时文件错误 | 清理临时文件夹，确保有足够空间 |

### 视频处理错误 (0xE2xx)

| 代码 | 严重等级 | 错误描述 | 处理建议 |
|------|----------|----------|----------|
| 0xE200 | 低 | 视频处理错误 | 检查视频文件完整性，尝试不同视频编码 |
| 0xE201 | 低 | 视频解码错误 | 确保安装了视频解码器，尝试转换视频格式 |
| 0xE202 | 低 | 视频编码错误 | 检查输出设置，尝试降低视频质量 |
| 0xE203 | 信息 | 视频质量错误 | 使用更高质量的视频源，或调整处理参数 |
| 0xE204 | 低 | 音频处理错误 | 检查音频轨道完整性，尝试提取和重新合并音频 |
| 0xE205 | 中 | 视频帧提取错误 | 检查视频是否可以正常播放，可能需要修复视频文件 |
| 0xE206 | 低 | 视频合成错误 | 检查输入素材格式是否一致，尝试中间格式转换 |
| 0xE207 | 中 | GPU加速错误 | 更新显卡驱动，或尝试禁用GPU加速 |

### 模型相关错误 (0xE4xx)

| 代码 | 严重等级 | 错误描述 | 处理建议 |
|------|----------|----------|----------|
| 0xE400 | 严重 | 模型加载错误 | 检查模型文件是否存在且完整，尝试重新下载模型 |
| 0xE401 | 中 | 模型推理错误 | 检查输入数据格式，可能需要重启应用程序 |
| 0xE402 | 低 | 模型版本错误 | 确保使用兼容的模型版本 |
| 0xE403 | 严重 | CUDA错误 | 更新NVIDIA驱动，检查CUDA版本兼容性 |
| 0xE404 | 中 | 模型精度错误 | 尝试使用不同精度的模型版本 |
| 0xE405 | 低 | 模型参数错误 | 检查模型配置文件，恢复默认设置 |
| 0xE406 | 中 | 模型内存错误 | 关闭其他应用释放内存，降低批处理大小 |
| 0xE407 | 严重 | 模型文件损坏 | 重新下载或恢复模型文件 |

## 在代码中处理错误

### 使用try-except捕获并记录错误

```python
from src.exporters.error_dashboard import get_error_monitor

monitor = get_error_monitor()
monitor.start_monitoring()

try:
    # 执行可能出错的操作
    process_video(video_path)
except Exception as e:
    # 记录错误到监控看板
    monitor.update_dashboard(e)
    
    # 尝试恢复或回退
    fallback_process(video_path)
```

### 使用错误码进行精确处理

```python
from src.utils.exceptions import ClipMasterError, ErrorCode

try:
    # 执行操作
    result = process_file(file_path)
except ClipMasterError as e:
    if e.code == ErrorCode.FILE_NOT_FOUND:
        # 文件未找到处理逻辑
        show_file_selector()
    elif e.code == ErrorCode.PERMISSION_DENIED:
        # 权限错误处理逻辑
        request_elevated_privileges()
    else:
        # 其他错误处理
        log_error_and_notify(e)
```

## 错误报告提交方式

遇到无法解决的错误时，请收集以下信息并报告给开发团队：

1. 错误代码和错误消息
2. 操作系统版本和环境信息
3. 重现步骤
4. 日志文件（位于`logs/error_dashboard.log`）
5. 应用版本号

可以通过以下方式提交错误报告：
- 发送邮件至：support@visionai-clipsmaster.com
- 在GitHub仓库创建Issue: https://github.com/visionai-clipsmaster/issues

## 最佳实践

- 定期查看错误监控看板，了解系统健康状况
- 对于频繁出现的错误，考虑修改工作流程避开问题
- 保持软件和驱动更新到最新版本
- 处理大型项目前先进行小规模测试，确认工作流程无误
- 对于模型相关错误，确保使用推荐的硬件配置 