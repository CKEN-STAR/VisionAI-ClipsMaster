#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
常量定义模块

存储整个项目中使用的常量值，以便集中管理和修改。
"""

# 情感检验相关常量
MAX_EMOTION_DELTA = 0.5  # 相邻场景情感最大变化阈值
MIN_EMOTION_VARIATION = 0.2  # 整个情感曲线中最小变化幅度
MIN_SCENES_FOR_CHECK = 2  # 最少场景数进行检验

# 视觉元素相关常量
MAX_VISUAL_DELTA = 0.6  # 相邻场景视觉风格最大变化阈值
MIN_VISUAL_CONTRAST = 0.3  # 最小视觉对比度

# 冲突强度相关常量
MAX_CONFLICT_DELTA = 0.55  # 相邻场景冲突强度最大变化阈值
CONFLICT_SCENE_RATIO = 0.4  # 有效冲突场景占比（高于阈值）

# 叙事结构相关常量
NARRATIVE_POSITIONS = ["introduction", "buildup", "climax", "resolution"]
NARRATIVE_MIN_CLIMAX_INTENSITY = 0.7  # 高潮部分最小情感强度
NARRATIVE_MAX_RESOLUTION_INTENSITY = 0.6  # 解决部分最大情感强度

# 情感类型相关常量
EMOTION_TYPES = {
    "en": ["joy", "sadness", "anger", "fear", "disgust", "surprise", "neutral"],
    "zh": ["喜悦", "悲伤", "愤怒", "恐惧", "厌恶", "惊讶", "中性"]
}

# 情感强度裁剪范围
EMOTION_INTENSITY_RANGE = (0.1, 1.0)  # 情感强度最小值和最大值

# 情感记忆触发器模板
MEMORY_TRIGGER_TEMPLATES = {
    # 情感类型触发模板
    "喜悦": [
        "[画面增亮，伴随轻柔音乐，唤起观众对欢乐时刻的共鸣]",
        "[特写镜头捕捉微笑细节，引发观众回忆类似的幸福瞬间]",
        "[节奏加快，色彩鲜明，创造让人想起美好记忆的氛围]"
    ],
    "悲伤": [
        "[画面色调转冷，慢镜头展现细节，唤起观众共情]",
        "[背景音乐转为钢琴旋律，触发观众对失落感的记忆]",
        "[光线减弱，画面逐渐褪色，引发观众回忆伤感经历]"
    ],
    "愤怒": [
        "[鼓点音效增强，震撼观众情绪，唤起对不公的记忆]",
        "[特写面部表情，让观众回想自身愤怒体验]",
        "[快速剪辑节奏，增加画面紧张感，引发情绪记忆]"
    ],
    "恐惧": [
        "[光影对比加强，暗部阴影增加，唤起本能恐惧记忆]",
        "[音效强调心跳声，让观众回想紧张时刻]",
        "[镜头晃动增加不稳定感，引发观众不安全感记忆]"
    ],
    "厌恶": [
        "[画面色调偏绿，引发观众对不适场景的记忆联想]",
        "[特写细节展示，唤起观众的感官记忆]",
        "[背景杂音增加，创造令人不舒适的氛围]"
    ],
    "惊讶": [
        "[突然的音效变化，激活观众意外感记忆]",
        "[快速推进镜头，营造出乎意料的感觉]",
        "[色彩突然变化，引发观众记忆中的惊讶时刻]"
    ],
    "中性": [
        "[平稳镜头，自然色调，让观众舒适观看]",
        "[背景环境音增强，营造真实感，拉近与观众距离]",
        "[稳定节奏剪辑，创造平静氛围]"
    ],
    
    # 情感记忆标签触发模板
    "高潮": [
        "[闪回画面：插入模糊回忆片段，唤起情感连接]",
        "[背景音乐高潮：旋律达到高潮，引发情感共鸣]",
        "[多角度蒙太奇：快速切换视角，增强情感冲击]"
    ],
    "胜利": [
        "[重复播放：关键动作慢动作重放，强化成就感]",
        "[色彩饱和度提升：画面鲜亮，唤起观众成功记忆]",
        "[音乐激昂：配乐转为激励性旋律，引发情感高涨]"
    ],
    "悲剧": [
        "[对比闪回：插入曾经幸福片段，强化当下失落]",
        "[静音处理：关键时刻突然无声，留给观众情感空间]",
        "[景深变化：背景虚化，突出人物孤独感]"
    ],
    "冲突": [
        "[交叉剪辑：快速切换对立双方，增强紧张感]",
        "[音乐节奏加快：配合冲突升级，引发观众情绪紧张]",
        "[色彩对比：使用对比色调，强化对抗氛围]"
    ],
    "启示": [
        "[光线变化：画面逐渐明亮，象征领悟]",
        "[慢镜头特写：捕捉顿悟瞬间，让观众共情]",
        "[背景声音淡出：创造思考空间，引发观众反思]"
    ],
    "离别": [
        "[远景拉长：逐渐拉远的镜头，象征分离]",
        "[物品特写：留下的纪念物，触发观众记忆]",
        "[音乐渐弱：旋律缓慢消退，营造不舍氛围]"
    ],
    "团聚": [
        "[慢动作拥抱：延长重逢瞬间，强化情感释放]",
        "[光线温暖：增加画面暖色调，营造温馨氛围]",
        "[背景模糊：聚焦人物情感，强化亲密连接]"
    ],
    "成长": [
        "[并列对比：过去与现在画面对比，展示变化]",
        "[环境变化：场景从局促到开阔，象征成长]",
        "[细节特写：成长标志物，引发观众共鸣]"
    ],
    "牺牲": [
        "[光影对比：强烈明暗对比，突出决定瞬间]",
        "[视角切换：主观镜头，让观众感同身受]",
        "[时间延展：关键时刻慢镜头，强化情感冲击]"
    ],
    "转折": [
        "[色调转变：画面色调明显变化，暗示转变]",
        "[音乐转变：配乐风格突然改变，强调剧情转向]",
        "[镜头角度变化：视角翻转，象征情节转折]"
    ]
}

# 性能相关常量
LOW_MEMORY_THRESHOLD_MB = 200  # 低内存警告阈值(MB)
CPU_HIGH_USAGE_THRESHOLD = 80  # CPU高使用率警告阈值(%) 

# 黄金标准质量评估阈值
class QUALITY_THRESHOLDS:
    """质量评估阈值定义"""
    
    # 黄金标准比较阈值
    GOLDEN_STANDARD = {
        "ssim": 0.92,         # 结构相似度指标阈值
        "psnr": 38.0,         # 峰值信噪比阈值(dB)
        "motion_consistency": 0.85  # 运动一致性阈值
    }
    
    # 音频质量评估阈值
    AUDIO_QUALITY = {
        "audio_psnr": 30.0,        # 音频峰值信噪比阈值(dB)
        "mfcc_similarity": 0.75,   # MFCC特征相似度阈值
        "spectral_contrast": 0.70  # 频谱对比度阈值
    }
    
    # 场景转换质量阈值
    SCENE_TRANSITION = {
        "scene_count_similarity": 0.80,      # 场景数量相似度阈值
        "transition_timing_similarity": 0.75, # 转换时机相似度阈值
        "overall_transition_quality": 0.80   # 整体转换质量阈值
    }
    
    # 质量等级划分
    QUALITY_RATINGS = {
        "S": 95.0,  # S级质量最低分
        "A": 85.0,  # A级质量最低分
        "B": 75.0,  # B级质量最低分
        "C": 65.0,  # C级质量最低分
        "D": 0.0    # D级质量最低分
    } 